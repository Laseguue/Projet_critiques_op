{% extends "base.html" %}

{% block content %}
<h2>Nouvelle Critique</h2>

{% if ticket %}
<div class="ticket-details">
    <h3>Détails du billet</h3>
    <strong>{{ ticket.title }}</strong> - <small>Créé par {{ ticket.user.username }}</small>
    <p>{{ ticket.description }}</p>
    {% if ticket.image %}
    <img src="{{ ticket.image.url }}" alt="{{ ticket.title }}" style="width: 200px; height: auto;">
    {% endif %}
</div>
{% endif %}

<form method="post" enctype="multipart/form-data">
    {% csrf_token %}

    {% if ticket_form %}
    <h3>Billet</h3>
    {{ ticket_form.as_p }}
    {% endif %}

    <h3>Critique</h3>
    <div>
        <label>{{ review_form.rating.label }}</label>
        {% for choice in review_form.rating.field.choices %}
        <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="{{ review_form.rating.name }}" id="rating{{ choice.0 }}" value="{{ choice.0 }}" {% if review_form.rating.value == choice.0 %}checked{% endif %}>
            <label class="form-check-label" for="rating{{ choice.0 }}">{{ choice.1 }} étoiles</label>
        </div>
        {% endfor %}
    </div>
    <div>
        {{ review_form.headline.label_tag }} {{ review_form.headline }}
    </div>
    <div>
        {{ review_form.body.label_tag }} {{ review_form.body }}
    </div>
    <div>
        {{ review_form.ticket.as_hidden }}  <!-- Ce champ doit rester caché -->
    </div>
    <div>
        {{ review_form.image.label_tag }} {{ review_form.image }}
    </div>

    <button type="submit">Créer</button>
</form>
{% endblock %}
